---
title: "Data Transformation Readings"
author: "Aurelia Ponzio"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This assignment included chapter 5 of R for Data Science. 
The reading can be found at https://r4ds.had.co.nz/transform.html

As always, we begin with tidyverse.
We'll use nycflights13 for our dataset.
``` {r}
#| label: load-packages
#| warning: false
#| message: false
library(tidyverse)
library(nycflights13)
```


## 5.2.4 Finding rows with filter

### 1. Find all flights that
  Had an arrival delay of two or more hours
  Flew to Houston (IAH or HOU)
  Were operated by United, American, or Delta
  Departed in summer (July, August, and September)
  Arrived more than two hours late, but didnâ€™t leave late
  Were delayed by at least an hour, but made up over 30 minutes in flight
  Departed between midnight and 6am (inclusive)

``` {r}
# arrival delay >= 2 hours
flights %>%
  filter(arr_delay >= 120)

# flew to Houston
flights %>%
  filter(dest == "IAH" | dest == "HOU")

# united, american, or delta
flights %>%
  filter(carrier == "UA" | carrier == "AA" | carrier == "DL")

# departed in summer
flights %>%
  filter(month == 7 | month == 8 | month == 9)

# more than two hours late when on time
flights %>%
  filter(dep_delay <= 0 & arr_delay > 120)

# delayed by an hour but made up over 30 mins
flights %>%
  filter(dep_delay >= 60 & arr_delay <= 30)

# departed between midnight and six am
flights %>%
  filter(hour >= 0 & hour <= 6)
```

### 2. Another useful dplyr filtering helper is between(). What does it do? Can you use it to simplify the code needed to answer the previous challenges?
According to the docs it is a way to find if a numeric value falls in a range.
It can be used to simplify the following questions:
``` {r}
# departed in summer
flights %>%
  filter(between(month, 7, 9))

# departed between midnight and six am
flights %>%
  filter(between(hour, 0, 6))
```

### 3. How many flights have a missing dep_time? What other variables are missing? What might these rows represent?
According to the below code, 8255 flights are missing their departure time.
These are flights that never took off.
``` {r}
flights %>%
  filter(is.na(dep_time)) %>%
  count()
```

Looking at the data frame, other missing variables include dep_delay, 
arr_time, arr_delay, tailnum, and air_time. 
Other than air_time, all of these can be accounted for by the plane either
not taking off or not landing.
Missing tailnums are probably flights that were registered but never given planes.

### 4. Why is NA ^ 0 not missing? Why is NA | TRUE not missing? Why is FALSE & NA not missing? Can you figure out the general rule? (NA * 0 is a tricky counterexample!)
NA ^ 0 isn't missing because R assumes that any number to the 0th is 1.
NA | TRUE isn't missing because the the second option is true so it will evaluate to true regardless of the value for NA.
FALSE & NA isn't missing for the same reason as above but flipped. Anything & FALSE will
evaluate to false.
The general rule is that NA stands in for some unknown so if the expression can be evaluated without that unknown it will be.


